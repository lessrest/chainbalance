<!doctype html>
<meta charset=utf-8>
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Blockchain Balance Monitor</title>
<style>
* { box-sizing: border-box; }
html, input, button { font: 22px/1.6 "times new roman"; }
body { max-width: 32rem; margin: 0 auto; padding: 1rem; text-align: center; }
input { font-family: courier, monospace; }
input { width: 100%; border: 1px solid #999; padding: .25rem .25rem 0; }
button { padding: .25rem 1rem; margin: 1rem 0; }
button { cursor: pointer; transition: 0.25s ease all; }
button.blocked { pointer-events: none; }
i { font-style: normal; color: #666; }
a { color: inherit; text-decoration: none; border-bottom: 1px solid currentcolor; }
</style>
<form id=form>
<h1>Balance Monitor</h2>
<h2>Ethereum main net</h2>
<p><input name=email placeholder="me@example.com"/>
<p><input name=address placeholder="0xfB6916095ca1df60bB79Ce92cE3Ea74c37c5d359"/>
<p><button id=button>Notify me when balance changes</button>
<p><i>All warranties disclaimed; provided as is.</i>
<p><i>Ethereum data from <a href="https://etherscan.io">etherscan.io</a>.</i>
<p><i>Powered by AWS Lambda.</i>
<p><i><a href="mailto:info@brockman.se">Email the operators.</a></i>
<script>
form.onsubmit = function(e) {
  e.preventDefault()
  var email = form.elements["email"].value
  var address = form.elements["address"].value

  if (!email.match(/^.+@.+$/) || !address.match(/^0x[0-9a-zA-Z]{40}$/)) {
    alert("Doesn't look right.")
    return
  }

  var req = new XMLHttpRequest()
  req.onload = function() {
    alert("OK, sending confirmation mail.")
    button.classList += "blocked";
    setTimeout(function() { button.classList.remove("blocked") }, 1000)
  }
  req.onerror = function() {
    alert("Something went wrong.")
  }
  req.open(
    "POST",
    "https://za0rknimh2.execute-api.eu-west-1.amazonaws.com/prod/"
  )
  req.setRequestHeader("content-type", "application/json")
  req.send(JSON.stringify({
    "emailAddress": email,
    "accountAddress": address
  }))
}
</script>    
